# DrWeb-CTF2024-EverlastingReverse
Writeup

![image](https://github.com/user-attachments/assets/87dfe27d-01e8-46a0-b923-2f2686728d4a)
В архиве лежит exeшник и файл с расширением .pck
Запускаем приложение, видим, что перед нами программа, написанная на godot движке:


![image](https://github.com/user-attachments/assets/f28aff06-07cc-40de-b27f-9079a4318747)
Т.к. перед нами Godot, попробуем восстановить все файлы и сам проект из архива game.pck через GDRE Tools
Однако архив запаролен... Требуется найти 256 битный ключ(32 байта)

В описании задания есть подсказка на то, что мы имеем дело с опенсорсным проектом. Так оно и есть - исходный код движка godot есть на гитхабе:

Параллельно гуглим запросы по типу: "how to extract the project key from godot application"
2я ссылка наталкивает нас на статью о ненадежности функции open_and_parse, которая открывает наш защищенный .pck файл, используя ключ в открытом виде.

Находим исходный код функции на гитхабе. Отсюда можно взять строки, по которым можно найти эту функцию в коде программы.
![image](https://github.com/user-attachments/assets/8f408308-5dc4-41c2-a7f7-ecf778669842)

Статический анализ.
Detect It Easy дает нам понять, что программа упакована(энтропия + нестандартные имена секций файла):
![image](https://github.com/user-attachments/assets/661053d0-0ec6-45d7-b165-c9f6d23f58a8)

Благо анти-дампа нет(установленно опытным путем), дампим прогу.
После снятия дампа, находим по строкам искомую функцию и вычисляем ее оффсет относительно базы. Оффсет равен 0xb00ef0.

Динамический анализ.
Попробуем протрассировать вызов API функций, используемых приложением, с целью понимания того, в какой момент можно остановить программу и присоединиться к ней отладчиком для отлова функции open_and_parse(пробовал напрямую установить бряк по адресу, однако при перезапуске проги, бряк слетал : ( )



